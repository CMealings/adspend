data <- readWorksheet(wb, 1, startRow = 23, endRow = 60, startCol = 1, endCol = 55, header = FALSE, colTypes = rep("character", 56))
View(data)
View(data)
data <- read.xlsx(path, 1, rowIndex = 23:60, colIndex = 1:55, keepFormulas = FALSE, header = FALSE)
meta <- read.xlsx(path, 1, rowIndex = 15:21, colIndex = 1:55, header = FALSE)
View(data)
colnames(data) <- c("Year", meta[, 15])
View(data)
colnames(data) <- c("Year", meta[15, ])
colnames(data) <- c("Year", meta[15, -1])
View(data)
meta[15, -1]
View(meta)
colnames(data) <- c("Year", meta[2, -1])
View(data)
meta[2, -1]
length(meta[2, -1])
c("Year", meta[2, -1])
colnames(data) <- c("Year", as.character(meta[2, -1]))
View(data)
c("Year", as.character(meta[2, -1]))
meta[2, -1]
as.character(meta[2, -1])
meta <- read.xlsx(path, 1, rowIndex = 15:21, colIndex = 1:55, header = FALSE, colClasses = c(rep("character", 4), rep("numeric", 2)))
colnames(data) <- c("Year", as.character(meta[2, -1]))
View(data)
View(meta)
meta <- read.xlsx(path, 1, rowIndex = 15:21, colIndex = 1:55, header = FALSE, colClasses = "character")
View(meta)
View(meta)
meta[5:7, ] <- apply(meta[, 5:7], 1:2, as.numeric)
meta <- read.xlsx(path, 1, rowIndex = 15:21, colIndex = 1:55, header = FALSE, colClasses = "character")
meta[5:7, ] <- apply(meta[5:7, ], 1:2, as.numeric)
View(meta)
data <- read.xlsx(path, 1, rowIndex = 23:60, colIndex = 1:55, keepFormulas = FALSE, header = FALSE, row.names = 1)
View(data)
View(meta)
meta <- read.xlsx(path, 1, rowIndex = 15:21, colIndex = 1:55, header = FALSE, colClasses = "character", row.names = 1)
meta[5:7, ] <- apply(meta[5:7, ], 1:2, as.numeric)
colnames(data) <- as.character(meta[2, -1])
View(data)
View(meta)
claas(meta[2,1])
class(meta[2,1])
meta <- read.xlsx(path, 1, rowIndex = 15:21, colIndex = 1:55, header = FALSE, colClasses = rep("character", 54), row.names = 1)
colnames(data) <- as.character(meta[2, -1])
View(data)
View(meta)
class(meta[2,1])
meta <- read.xlsx(path, 1, rowIndex = 15:21, colIndex = 1:55, header = FALSE, colClasses = rep("character", 55), row.names = 1)
class(meta[2,1])
meta <- read.xlsx(path, 1, rowIndex = 15:21, colIndex = 1:55, header = FALSE, stringsAsFactors = FALSE, row.names = 1)
meta[5:7, ] <- apply(meta[5:7, ], 1:2, as.numeric)
colnames(data) <- as.character(meta[2, -1])
View(meta)
View(data)
View(data)
View(meta)
colnames(data) <- as.character(meta["SeriesCode", -1])
colnames(data) <- meta["SeriesCode", ]
View(data)
path <- "E:/TYPESET/International Data/Adspend database/Database (NEW FORMAT)/"
datasets <- grep("\\.xlsx$|\\.xlsm$")
datasets <- grep("\\.xlsx$|\\.xlsm$", list.files(path))
datasets <- grep("\\.xlsx$|\\.xlsm$", list.files(path), value = TRUE)
datasets
grep("^~\$", datasets)
grep("^~$", datasets)
grep("^~\\$", datasets)
grep("^~\\$", datasets, value = )
grep("^~\\$", datasets, value = T)
# exclude temp files
datasets <- datasets[grep("^~\\$", datasets, value = TRUE)]
# exclude temp files
datasets <- datasets[-grep("^~\\$", datasets, value = TRUE)]
# exclude temp files
datasets <- datasets[-grep("^~\\$", datasets, value = TRUE)]
datasets <- grep("\\.xlsx$|\\.xlsm$", list.files(path), value = TRUE)
# exclude temp files
datasets <- datasets[-grep("^~\\$", datasets)]
datasets
?xlsx
?list
openToolbox()
View(openToolbox)
path <- Sys.getenv("TOOLBOX")
path <- Sys.getenv("TOOLBOX")
openToolbox()
View(openToolbox)
openToolbox <- function() {
path <- Sys.getenv("TOOLBOX")
toolbox <- grep(".R$", list.files(path), value = TRUE)
for (tool in toolbox)
source(paste0(path, "\\", tool))
}
View(openToolbox)
openToolbox()
reqPackages(c("xlsx", "abind"))
folder <- "E:/TYPESET/International Data/Adspend database/Database (NEW FORMAT)/"
# list excel datasets
datasets <- grep("\\.xlsx$|\\.xlsm$", list.files(folder), value = TRUE)
# exclude temp files
datasets <- datasets[-grep("^~\\$", datasets)]
df <- NULL
mf <- NULL
for (wb in datasets) {
browser()
path <- paste0(folder, wb)
sheets <- getSheets(loadWorkbook(path))
sheets <- sheets[!c("Sheet2", "Sheet3", "Countries", "Asia Pacific Counts", "Africa Counts", "Latin America Counts", "MiddleEast Counts")]
for (sht in sheets) {
data <- read.xlsx(path, sht, rowIndex = 23:60, colIndex = 1:55, keepFormulas = FALSE, header = FALSE, row.names = 1)
meta <- read.xlsx(path, sht, rowIndex = 1:21, colIndex = 1:55, header = FALSE, stringsAsFactors = FALSE, row.names = 1)
setName <- meta[1, 1]
dateUpdated <- meta[2, 1]
regionCode <- meta[3, 1]
meta <- meta[15:21, ]
meta[5:7, ] <- apply(meta[5:7, ], 1:2, as.numeric)
meta <- list("setName" = setName, "dateUpdated" = dateUpdated, "regionCode" = regionCode, "meta" = meta)
colnames(data) <- meta["SeriesCode", ]
mf <- abind(mf, meta, along = 3)
df <- abind(df, data, along = 3)
}
}
reqPackages(c("xlsx", "abind"))
folder <- "E:/TYPESET/International Data/Adspend database/Database (NEW FORMAT)/"
# list excel datasets
datasets <- grep("\\.xlsx$|\\.xlsm$", list.files(folder), value = TRUE)
# exclude temp files
datasets <- datasets[-grep("^~\\$", datasets)]
df <- NULL
mf <- NULL
for (wb in datasets) {
browser()
path <- paste0(folder, wb)
sheets <- getSheets(loadWorkbook(path))
sheets <- sheets[-c("Sheet2", "Sheet3", "Countries", "Asia Pacific Counts", "Africa Counts", "Latin America Counts", "MiddleEast Counts")]
for (sht in sheets) {
data <- read.xlsx(path, sht, rowIndex = 23:60, colIndex = 1:55, keepFormulas = FALSE, header = FALSE, row.names = 1)
meta <- read.xlsx(path, sht, rowIndex = 1:21, colIndex = 1:55, header = FALSE, stringsAsFactors = FALSE, row.names = 1)
setName <- meta[1, 1]
dateUpdated <- meta[2, 1]
regionCode <- meta[3, 1]
meta <- meta[15:21, ]
meta[5:7, ] <- apply(meta[5:7, ], 1:2, as.numeric)
meta <- list("setName" = setName, "dateUpdated" = dateUpdated, "regionCode" = regionCode, "meta" = meta)
colnames(data) <- meta["SeriesCode", ]
mf <- abind(mf, meta, along = 3)
df <- abind(df, data, along = 3)
}
}
unlist(sheets)
names(sheets)
sheets <- names(getSheets(loadWorkbook(path)))
sheets <- sheets[!c("Sheet2", "Sheet3", "Countries", "Asia Pacific Counts", "Africa Counts", "Latin America Counts", "MiddleEast Counts")]
sheets <- sheets[sheets != c("Sheet2", "Sheet3", "Countries", "Asia Pacific Counts", "Africa Counts", "Latin America Counts", "MiddleEast Counts")]
sheets <- sheets[!c("Sheet2", "Sheet3", "Countries", "Asia Pacific Counts", "Africa Counts", "Latin America Counts", "MiddleEast Counts") %in% sheets]
c("Sheet2", "Sheet3", "Countries", "Asia Pacific Counts", "Africa Counts", "Latin America Counts", "MiddleEast Counts") %in% sheets
sheets <- names(getSheets(loadWorkbook(path)))
sheets %in% c("Sheet2", "Sheet3", "Countries", "Asia Pacific Counts", "Africa Counts", "Latin America Counts", "MiddleEast Counts")
sheets <- names(getSheets(loadWorkbook(path)))
sheets <- sheets[!c("Sheet2", "Sheet3", "Countries", "Asia Pacific Counts", "Africa Counts", "Latin America Counts", "MiddleEast Counts") %in% sheets]
sheets <- names(getSheets(loadWorkbook(path)))
sheets %in% c("Sheet2", "Sheet3", "Countries", "Asia Pacific Counts", "Africa Counts", "Latin America Counts", "MiddleEast Counts")
sheets
sheets <- names(getSheets(loadWorkbook(path)))
sheets <- sheets[!sheets %in% c("Sheet2", "Sheet3", "Countries", "Asia Pacific Counts", "Africa Counts", "Latin America Counts", "MiddleEast Counts", "Template")]
reqPackages(c("xlsx", "abind"))
folder <- "E:/TYPESET/International Data/Adspend database/Database (NEW FORMAT)/"
# list excel datasets
datasets <- grep("\\.xlsx$|\\.xlsm$", list.files(folder), value = TRUE)
# exclude temp files
datasets <- datasets[-grep("^~\\$", datasets)]
df <- NULL
mf <- NULL
for (wb in datasets) {
browser()
path <- paste0(folder, wb)
sheets <- names(getSheets(loadWorkbook(path)))
sheets <- sheets[!sheets %in% c("Sheet2", "Sheet3", "Countries", "Asia Pacific Counts", "Africa Counts", "Latin America Counts", "MiddleEast Counts", "Template")]
for (sht in sheets) {
data <- read.xlsx(path, sht, rowIndex = 23:60, colIndex = 1:55, keepFormulas = FALSE, header = FALSE, row.names = 1)
meta <- read.xlsx(path, sht, rowIndex = 1:21, colIndex = 1:55, header = FALSE, stringsAsFactors = FALSE, row.names = 1)
setName <- meta[1, 1]
dateUpdated <- meta[2, 1]
regionCode <- meta[3, 1]
meta <- meta[15:21, ]
meta[5:7, ] <- apply(meta[5:7, ], 1:2, as.numeric)
meta <- list("setName" = setName, "dateUpdated" = dateUpdated, "regionCode" = regionCode, "meta" = meta)
colnames(data) <- meta["SeriesCode", ]
mf <- abind(mf, meta, along = 3)
df <- abind(df, data, along = 3)
}
}
reqPackages(c("xlsx", "abind"))
folder <- "E:/TYPESET/International Data/Adspend database/Database (NEW FORMAT)/"
# list excel datasets
datasets <- grep("\\.xlsx$|\\.xlsm$", list.files(folder), value = TRUE)
# exclude temp files
datasets <- datasets[-grep("^~\\$", datasets)]
df <- NULL
mf <- NULL
for (wb in datasets) {
path <- paste0(folder, wb)
sheets <- names(getSheets(loadWorkbook(path)))
sheets <- sheets[!sheets %in% c("Sheet2", "Sheet3", "Countries", "Asia Pacific Counts", "Africa Counts", "Latin America Counts", "MiddleEast Counts", "Template")]
for (sht in sheets) {
browser()
data <- read.xlsx(path, sht, rowIndex = 23:60, colIndex = 1:55, keepFormulas = FALSE, header = FALSE, row.names = 1)
meta <- read.xlsx(path, sht, rowIndex = 1:21, colIndex = 1:55, header = FALSE, stringsAsFactors = FALSE, row.names = 1)
setName <- meta[1, 1]
dateUpdated <- meta[2, 1]
regionCode <- meta[3, 1]
meta <- meta[14:21, ]
meta[5:7, ] <- apply(meta[5:7, ], 1:2, as.numeric)
meta <- list("setName" = setName, "dateUpdated" = dateUpdated, "regionCode" = regionCode, "meta" = meta)
colnames(data) <- meta["SeriesCode", ]
mf <- abind(mf, meta, along = 3)
df <- abind(df, data, along = 3)
}
}
View(data)
reqPackages(c("xlsx", "abind"))
folder <- "E:/TYPESET/International Data/Adspend database/Database (NEW FORMAT)/"
# list excel datasets
datasets <- grep("\\.xlsx$|\\.xlsm$", list.files(folder), value = TRUE)
# exclude temp files
datasets <- datasets[-grep("^~\\$", datasets)]
df <- NULL
mf <- NULL
for (wb in datasets) {
path <- paste0(folder, wb)
sheets <- names(getSheets(loadWorkbook(path)))
sheets <- sheets[!sheets %in% c("Sheet2", "Sheet3", "Countries", "Asia Pacific Counts", "Africa Counts", "Latin America Counts", "MiddleEast Counts", "Template")]
for (sht in sheets) {
data <- read.xlsx(path, sht, rowIndex = 23:60, colIndex = 1:55, keepFormulas = FALSE, header = FALSE, row.names = 1)
meta <- read.xlsx(path, sht, rowIndex = 1:21, colIndex = 1:55, header = FALSE, stringsAsFactors = FALSE)
row.names(meta) <- meta[, 1]
browser()
setName <- meta[1, 1]
dateUpdated <- meta[2, 1]
regionCode <- meta[3, 1]
meta <- meta[14:21, ]
meta[5:7, ] <- apply(meta[5:7, ], 1:2, as.numeric)
meta <- list("setName" = setName, "dateUpdated" = dateUpdated, "regionCode" = regionCode, "meta" = meta)
colnames(data) <- meta["SeriesCode", ]
mf <- abind(mf, meta, along = 3)
df <- abind(df, data, along = 3)
}
}
reqPackages(c("xlsx", "abind"))
folder <- "E:/TYPESET/International Data/Adspend database/Database (NEW FORMAT)/"
# list excel datasets
datasets <- grep("\\.xlsx$|\\.xlsm$", list.files(folder), value = TRUE)
# exclude temp files
datasets <- datasets[-grep("^~\\$", datasets)]
df <- NULL
mf <- NULL
for (wb in datasets) {
path <- paste0(folder, wb)
sheets <- names(getSheets(loadWorkbook(path)))
sheets <- sheets[!sheets %in% c("Sheet2", "Sheet3", "Countries", "Asia Pacific Counts", "Africa Counts", "Latin America Counts", "MiddleEast Counts", "Template")]
for (sht in sheets) {
data <- read.xlsx(path, sht, rowIndex = 23:60, colIndex = 1:55, keepFormulas = FALSE, header = FALSE, row.names = 1)
meta <- read.xlsx(path, sht, rowIndex = 14:21, colIndex = 1:55, header = FALSE, stringsAsFactors = FALSE, row.names = 1)
browser()
countryMeta <- read.xlsx(path, sht, rowIndex = 1:3, colIndex = 1, header = FALSE, stringsAsFactors = FALSE)
setName <- meta[1, 1]
dateUpdated <- meta[2, 1]
regionCode <- meta[3, 1]
meta <- meta[14:21, ]
meta[5:7, ] <- apply(meta[5:7, ], 1:2, as.numeric)
meta <- list("setName" = setName, "dateUpdated" = dateUpdated, "regionCode" = regionCode, "meta" = meta)
colnames(data) <- meta["SeriesCode", ]
mf <- abind(mf, meta, along = 3)
df <- abind(df, data, along = 3)
}
}
x <- read.xlsx(path)
x <- read.xlsx(path,1)
x <- loadWorkbook(path)
?xlread
library(readxl)
?readxl
readWorksheet
?readWorksheet
library(XLConnect)
?readWorksheet
reqPackages(c("xlsx", "abind"))
folder <- "E:/TYPESET/International Data/Adspend database/Database (NEW FORMAT)/"
# list excel datasets
datasets <- grep("\\.xlsx$|\\.xlsm$", list.files(folder), value = TRUE)
# exclude temp files
datasets <- datasets[-grep("^~\\$", datasets)]
df <- NULL
mf <- NULL
for (wb in datasets) {
path <- paste0(folder, wb)
file <- loadWorkbook(path)
sheets <- names(getSheets(file))
sheets <- sheets[!sheets %in% c("Sheet2", "Sheet3", "Countries", "Asia Pacific Counts", "Africa Counts", "Latin America Counts", "MiddleEast Counts", "Template")]
for (sht in sheets) {
# data <- read.xlsx(path, sht, rowIndex = 23:60, colIndex = 1:55, keepFormulas = FALSE, header = FALSE, row.names = 1)
data <- readWorksheet(file, sht, startRow = 1, endRow = 60, startCol = 1, endCol = 55, useCachedValues = TRUE, header = FALSE, stringsAsFactors = FALSE)
browser()
# meta <- read.xlsx(path, sht, rowIndex = 14:21, colIndex = 1:55, header = FALSE, stringsAsFactors = FALSE, row.names = 1)
countryMeta <- read.xlsx(path, sht, rowIndex = 1:3, colIndex = 1, header = FALSE, stringsAsFactors = FALSE)
setName <- countryMeta[1, 1]
dateUpdated <- countryMeta[2, 1]
regionCode <- countryMeta[3, 1]
meta <- meta[14:21, ]
meta[5:7, ] <- apply(meta[5:7, ], 1:2, as.numeric)
meta <- list("setName" = setName, "dateUpdated" = dateUpdated, "regionCode" = regionCode, "meta" = meta)
colnames(data) <- meta["SeriesCode", ]
mf <- abind(mf, meta, along = 3)
df <- abind(df, data, along = 3)
}
}
file <- loadWorkbook(path)
folder <- "E:/TYPESET/International Data/Adspend database/Database (NEW FORMAT)/"
# list excel datasets
datasets <- grep("\\.xlsx$|\\.xlsm$", list.files(folder), value = TRUE)
# exclude temp files
datasets <- datasets[-grep("^~\\$", datasets)]
df <- NULL
mf <- NULL
for (wb in datasets) {
path <- paste0(folder, wb)
file <- loadWorkbook(path)
sheets <- names(getSheets(file))
sheets <- sheets[!sheets %in% c("Sheet2", "Sheet3", "Countries", "Asia Pacific Counts", "Africa Counts", "Latin America Counts", "MiddleEast Counts", "Template")]
for (sht in sheets) {
# data <- read.xlsx(path, sht, rowIndex = 23:60, colIndex = 1:55, keepFormulas = FALSE, header = FALSE, row.names = 1)
data <- readWorksheet(file, sht, startRow = 1, endRow = 60, startCol = 1, endCol = 55, useCachedValues = TRUE, header = FALSE, stringsAsFactors = FALSE)
browser()
# meta <- read.xlsx(path, sht, rowIndex = 14:21, colIndex = 1:55, header = FALSE, stringsAsFactors = FALSE, row.names = 1)
countryMeta <- read.xlsx(path, sht, rowIndex = 1:3, colIndex = 1, header = FALSE, stringsAsFactors = FALSE)
setName <- countryMeta[1, 1]
dateUpdated <- countryMeta[2, 1]
regionCode <- countryMeta[3, 1]
meta <- meta[14:21, ]
meta[5:7, ] <- apply(meta[5:7, ], 1:2, as.numeric)
meta <- list("setName" = setName, "dateUpdated" = dateUpdated, "regionCode" = regionCode, "meta" = meta)
colnames(data) <- meta["SeriesCode", ]
mf <- abind(mf, meta, along = 3)
df <- abind(df, data, along = 3)
}
}
openToolbox()
View(openToolbox)
openToolbox <- function() {
path <- paste0(Sys.getenv("TOOLBOX"), "\\Rstartup")
toolbox <- grep(".R$", list.files(path), value = TRUE)
for (tool in toolbox)
source(paste0(path, "\\", tool))
}
openToolbox()
reqPackages(c("xlsx", "abind", "readxl"))
folder <- "E:/TYPESET/International Data/Adspend database/Database (NEW FORMAT)/"
# list excel datasets
datasets <- grep("\\.xlsx$|\\.xlsm$", list.files(folder), value = TRUE)
# exclude temp files
datasets <- datasets[-grep("^~\\$", datasets)]
df <- NULL
mf <- NULL
path <- paste0(folder, datasets[1])
x <- readxl(path)
x <- read_excel(path)
View(x)
x <- read_excel(path, 4)
sht <- 4
# data <- read.xlsx(path, sht, rowIndex = 23:60, colIndex = 1:55, keepFormulas = FALSE, header = FALSE, row.names = 1)
data <- read_excel(path, sht, range = "A14:CF60", header = FALSE, row.names = 1, stringsAsFactors = FALSE)
# data <- read.xlsx(path, sht, rowIndex = 23:60, colIndex = 1:55, keepFormulas = FALSE, header = FALSE, row.names = 1)
data <- read_excel(path, sht, range = "A14:CF60")
View(data)
# data <- read.xlsx(path, sht, rowIndex = 23:60, colIndex = 1:55, keepFormulas = FALSE, header = FALSE, row.names = 1)
data <- read_excel(path, sht, range = "A14:CF60", col_names = FALSE)
View(data)
View(data)
# data <- read.xlsx(path, sht, rowIndex = 23:60, colIndex = 1:55, keepFormulas = FALSE, header = FALSE, row.names = 1)
data <- read_excel(path, sht, range = "A1:CF60", col_names = FALSE)
View(data)
View(data)
View(data)
# data <- read.xlsx(path, sht, rowIndex = 23:60, colIndex = 1:55, keepFormulas = FALSE, header = FALSE, row.names = 1)
data <- read_excel(path, sht, range = "A1:CF60", col_names = FALSE)
setName <- data[1, 2]
dateUpdated <- data[2, 2]
setName <- as.character(data[1, 2])
dateUpdated <- as.character(data[2, 2])
regionCode <- as.character(data[3, 2])
dateUpdated <- as.Date(data[2, 2])
data[2, 2]
View(data)
class(data[2,2])
type(data[2,2])
Type(data[2,2])
mode(data[2,2])
data[2,2][1]
data[2,2][[1]]
setName <- as.character(data[1, 2][[1]])
dateUpdated <- as.Date(data[2, 2][[1]])
dateUpdated <- as.POSIXct(data[2, 2][[1]])
dateUpdated <- as.numeric(data[2, 2][[1]])
meta <- data[14:21, -1]
View(meta)
rownames(meta) <- data[14:21, 1]
class(data)
meta <- as.data.frame(data[14:21, -1])
class(data)
rownames(meta) <- data[14:21, 1]
rownames(meta) <- as.vector(data[14:21, 1])
as.vector(data[14:21, 1])
as.character(data[14:21, 1])
as.character(data[14:21, 1][1])
as.character(data[14:21, 1][[1]])
data[14:21, 1][[1]]
meta[5,1]
meta[5,2]
View(meta)
class(meta[6,2])
meta[6,2]
meta[5:7, ] <- apply(meta[6:8, ], 1:2, as.numeric)
# data <- read.xlsx(path, sht, rowIndex = 23:60, colIndex = 1:55, keepFormulas = FALSE, header = FALSE, row.names = 1)
data <- read_excel(path, sht, range = "A1:CF60", col_names = FALSE)
setName <- as.character(data[1, 2])
dateUpdated <- as.numeric(data[2, 2][[1]])
regionCode <- as.character(data[3, 2])
meta <- as.data.frame(data[14:21, -1])
rownames(meta) <- data[14:21, 1][[1]]
meta[6:8, ] <- apply(meta[6:8, ], 1:2, as.numeric)
meta <- list("setName" = setName, "dateUpdated" = dateUpdated, "regionCode" = regionCode, "meta" = meta)
View(meta)
data <- data.frame(data[23:60, -1], row.names = data[23:60, 1])
data <- data.frame(data[23:60, -1], row.names = data[23:60, 1][[1]])
View(data)
length(meta["SeriesCode", ])
length(meta["SeriesCode", ][[1]])
dim(meta["SeriesCode", ][[1]])
# data <- read.xlsx(path, sht, rowIndex = 23:60, colIndex = 1:55, keepFormulas = FALSE, header = FALSE, row.names = 1)
data <- read_excel(path, sht, range = "A1:CF60", col_names = FALSE)
setName <- as.character(data[1, 2])
data <- data.frame(data[23:60, -1], row.names = data[23:60, 1][[1]])
colnames(data) <- meta$data["SeriesCode", ]
# data <- read.xlsx(path, sht, rowIndex = 23:60, colIndex = 1:55, keepFormulas = FALSE, header = FALSE, row.names = 1)
data <- read_excel(path, sht, range = "A1:CF60", col_names = FALSE)
read_excel(path, 1, range = "A1:CF60", col_names = FALSE)
x <- read_excel(path, sht, col_names = FALSE)
x <- read_excel(path, 1, col_names = FALSE)
reqPackages(c("xlsx", "abind", "readxl"))
openToolbox <- function() {
path <- paste0(Sys.getenv("TOOLBOX"), "\\Rstartup")
toolbox <- grep(".R$", list.files(path), value = TRUE)
for (tool in toolbox)
source(paste0(path, "\\", tool))
}
openToolbox()
reqPackages(c("xlsx", "abind", "readxl"))
folder <- "E:/TYPESET/International Data/Adspend database/Database (NEW FORMAT)/"
# list excel datasets
datasets <- grep("\\.xlsx$|\\.xlsm$", list.files(folder), value = TRUE)
# exclude temp files
datasets <- datasets[-grep("^~\\$", datasets)]
df <- NULL
mf <- NULL
path <- paste0(folder, datasets[1])
# data <- read.xlsx(path, sht, rowIndex = 23:60, colIndex = 1:55, keepFormulas = FALSE, header = FALSE, row.names = 1)
data <- read_excel(path, sht, range = "A1:CF60", col_names = FALSE)
x <- read_excel(path, 1, range = "A1:CF60", col_names = FALSE)
rm(x)
x <- read_excel(path, 4, range = "A1:CF60", col_names = FALSE)
rm(x)
x <- read_excel(path, 4, range = "A1:CF60", col_names = FALSE)
size(x)
Size(x)
filesize(x)
file.size(x)
file.info(x)
obj.info(x)
rm(x)
reqPackages(c("xlsx", "abind", "readxl"))
folder <- "E:/TYPESET/International Data/Adspend database/Database (NEW FORMAT)/"
# list excel datasets
datasets <- grep("\\.xlsx$|\\.xlsm$", list.files(folder), value = TRUE)
# exclude temp files
datasets <- datasets[-grep("^~\\$", datasets)]
df <- NULL
mf <- NULL
for (wb in datasets) {
path <- paste0(folder, wb)
file <- loadWorkbook(path)
sheets <- names(getSheets(file))
sheets <- sheets[!sheets %in% c("Sheet2", "Sheet3", "Countries", "Asia Pacific Counts", "Africa Counts", "Latin America Counts", "MiddleEast Counts", "Template")]
for (sht in sheets) {
# data <- read.xlsx(path, sht, rowIndex = 23:60, colIndex = 1:55, keepFormulas = FALSE, header = FALSE, row.names = 1)
data <- read_excel(path, sht, range = "A1:CF60", col_names = FALSE)
setName <- as.character(data[1, 2])
dateUpdated <- as.numeric(data[2, 2][[1]])
regionCode <- as.character(data[3, 2])
meta <- as.data.frame(data[14:21, -1])
rownames(meta) <- data[14:21, 1][[1]]
meta[6:8, ] <- apply(meta[6:8, ], 1:2, as.numeric)
meta <- list("setName" = setName, "dateUpdated" = dateUpdated, "regionCode" = regionCode, "data" = meta)
data <- data.frame(data[23:60, -1], row.names = data[23:60, 1][[1]])
colnames(data) <- meta$data["SeriesCode", ]
mf <- abind(mf, meta, along = 3)
df <- abind(df, data, along = 3)
}
}
?abind
apply(data, 2, class)
